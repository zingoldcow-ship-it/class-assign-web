<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ë°˜ë°°ì • ë„ìš°ë¯¸ (ë¸Œë¼ìš°ì € ì „ìš©)</title>
  <style>
    :root{ --bg:#f6f7fb; --card:#ffffff; --text:#0f172a; --muted:#475569; --accent:#60a5fa; --danger:#dc2626; --ok:#16a34a; --desc:#1d4ed8; --subtle:#64748b; --titleAccent:#0f172a; --border:rgba(15,23,42,.12); }
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Noto Sans KR,Arial,sans-serif;background:var(--bg);color:var(--text);}
    header{padding:16px;border-bottom:1px solid var(--border);position:sticky;top:0;background:rgba(246,247,251,.9);backdrop-filter:blur(8px);z-index:50;}
    .wrap{max-width:1300px;margin:0 auto;padding:14px;}
    h1{margin:0;font-size:18px;}
    /* Intro title larger */
    #headerIntro h1{font-size:28px; letter-spacing:-0.2px;}
    .sub{margin-top:6px;color:var(--muted);font-size:13px;line-height:1.4}
    .sub .flow{color:var(--desc)}
    .sub .privacy{color:var(--subtle)}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .pill{font-size:12px;border:1px solid rgba(15,23,42,.14);padding:6px 10px;border-radius:999px;color:var(--muted);background:rgba(15,23,42,.02)}
    .pill.ok{border-color:rgba(34,197,94,.45);background:rgba(34,197,94,.12);color:var(--text)}
    .pill.total{border-color:rgba(37,99,235,.35);background:rgba(37,99,235,.10);color:var(--text)}
    .pill.warn{border-color:rgba(255,107,107,.55);color:#b42318;background:rgba(255,107,107,.10)}
    /* Big split tabs (í™”ë©´ ì–‘ë¶„ í˜•íƒœ) */
    .tabs{display:flex;gap:12px;margin-top:12px;}
    .tabBtn{
      flex:1;
      background:rgba(15,23,42,.05);
      border:1px solid rgba(15,23,42,.12);
      color:var(--text);
      padding:12px 14px;
      border-radius:999px;
      cursor:pointer;
      font-weight:900;
      font-size:14px;
    }
    .tabBtn.active{background:rgba(96,165,250,.40);color:#0b1220;border-color:rgba(37,99,235,.20)}
    .tabBtn:disabled{opacity:.45}
    /* (keep base tabBtn here; size tweaks for levelTabs are set near the bottom) */
    .app{display:grid;grid-template-columns:340px 1fr;gap:14px;align-items:start}
    @media (max-width: 980px){ .app{grid-template-columns:1fr;} }
    .card{background:var(--card);border:1px solid rgba(15,23,42,.08);border-radius:14px;padding:14px;box-shadow:0 8px 24px rgba(0,0,0,.25);}
    .panelTitle{font-size:14px;margin:0 0 10px 0;}
    .divider{height:1px;background:rgba(15,23,42,.08);margin:12px 0;}
    label{font-size:12px;color:var(--muted);display:block;margin-bottom:6px}
    /* Setup panel readability (ë¼ë²¨ì´ ë” í¬ê³ , ì…ë ¥ê°’ì€ í•œ ë‹¨ê³„ ì‘ê²Œ) */
    #setupTab aside.card label{font-size:16px; line-height:1.25; font-weight:900; color:var(--text); opacity:.95;}
    #setupTab aside.card input[type=file],
    #setupTab aside.card input[type=number],
    #setupTab aside.card select{font-size:14px;}

    /* ì„¤ì • ìš”ì•½ ë°•ìŠ¤ */
    .summaryBox{margin:10px 0 6px 0; padding:10px 12px; border:1px solid rgba(15,23,42,.10); border-radius:12px; background:rgba(15,23,42,.03);}
    .summaryBox .t{font-weight:900; margin-bottom:6px;}
    .summaryBox .l{font-size:13px; color:var(--muted); line-height:1.35;}

    /* ì‹¤í–‰ ë²„íŠ¼ í•˜ë‹¨ ê³ ì •(ì„¤ì • íŒ¨ë„ ë‚´) */
    .stickyRun{position:sticky; bottom:0; padding-top:10px; background:linear-gradient(to bottom, rgba(246,247,251,0), rgba(246,247,251,.92) 22%, rgba(246,247,251,.98)); border-top:1px solid rgba(15,23,42,.08); margin-top:10px;}
    .stickyRun .tip{font-size:12px; color:#111827; margin-top:8px; background:rgba(254, 249, 195, 1); border:1px solid rgba(245, 158, 11, .55); padding:8px 10px; border-radius:12px;}




    select:focus{border-color:rgba(96,165,250,.8)}
    option{background:#ffffff;color:var(--text)}
    input[type=file]{padding:10px;border-radius:12px;border:1px dashed rgba(15,23,42,.18);background:rgba(15,23,42,.03);color:var(--text)}
    input[type=number],select{padding:10px;border-radius:12px;border:1px solid rgba(15,23,42,.12);background:rgba(15,23,42,.03);color:var(--text)}
    input[type=range]{width:100%;accent-color:var(--accent)}
    .kv{display:flex;justify-content:space-between;gap:10px;font-size:12px;color:var(--muted);margin-top:6px}
    button{background:var(--accent);border:none;color:#0b1220;padding:11px 12px;border-radius:12px;font-weight:900;cursor:pointer;width:auto}
    /* Lighter blue for result download */
    .downloadBtn{display:inline-flex;align-items:center;gap:10px;padding:14px 18px;border-radius:16px;font-size:15px;font-weight:950;min-width:220px;background:rgba(96,165,250,.35);border:1px solid rgba(37,99,235,.22);}
    .downloadBtn:hover{background:rgba(96,165,250,.42)}
    .downloadBtn .btnIcon{font-size:18px;line-height:1;}

    .btnSecondary{background:rgba(15,23,42,.07);border:1px solid rgba(15,23,42,.14);color:var(--text)}
    .btn, .btnSecondary, #fileBtn, #runBtn{width:100%}
    .tabBtn{width:auto}
    .homeBtn{width:auto}

    button:disabled{opacity:.4;cursor:not-allowed}
    .small{font-size:12px;color:var(--muted)}
    .subNote{display:block;font-size:12px;line-height:1.25;color:var(--subtle);font-weight:700;margin-top:2px;}

    .danger{color:var(--danger)}
    .overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.55);z-index:100;}
    .overlay .box{background:var(--card);border:1px solid rgba(15,23,42,.14);padding:16px;border-radius:14px;max-width:520px;width:calc(100% - 28px);}
    .spinner{width:18px;height:18px;border-radius:50%;border:3px solid rgba(15,23,42,.2);border-top-color:rgba(122,162,255,.9);animation:spin 1s linear infinite;display:inline-block;vertical-align:-4px;margin-right:8px;}
    @keyframes spin{to{transform:rotate(360deg)}}
    table{width:100%;border-collapse:collapse;font-size:12px}
    th,td{border-bottom:1px solid var(--border);padding:8px 6px;text-align:left;white-space:nowrap}
    th{color:var(--text);font-weight:800;position:sticky;top:0;background:rgba(253,230,138,.55)}
    .chartGrid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    @media (max-width: 980px){ .chartGrid{grid-template-columns:1fr;} }
    .chartBox{height:260px;position:relative}
    canvas{width:100% !important;height:100% !important;display:block}
    a{color:var(--accent)}

    /* Header home button */
    .headerTop{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;}
    .homeBtn{display:inline-flex;align-items:center;gap:10px;background:rgba(37,99,235,.10);border:1px solid rgba(37,99,235,.25);color:var(--text);padding:12px 14px;border-radius:999px;cursor:pointer;font-weight:950;font-size:16px;}
    .homeBtn:hover{background:rgba(37,99,235,.14)}
    
    .mintBtn{background:rgba(16,185,129,.14);border:1px solid rgba(16,185,129,.35);color:var(--text)}
    .mintBtn:hover{background:rgba(16,185,129,.18)}
    /* Light pink upload button */
    .pinkBtn{background:rgba(244,114,182,.18);border:1px solid rgba(244,114,182,.40);color:var(--text)}
    .pinkBtn:hover{background:rgba(244,114,182,.24)}
.homeIcon{width:22px;height:22px;display:inline-block}

    /* Accordion (ì„¤ì • ì„¹ì…˜ ì ‘ê¸°) */
    .acc{border:1px solid rgba(15,23,42,.10);border-radius:14px;background:rgba(15,23,42,.03);padding:10px 12px;margin:10px 0;}
    /* ì„¹ì…˜ ì œëª©(ê¸°ë³¸ ì„¤ì •/í•™ì—…Â·ê´€ê³„Â·ë¯¼ì›Â·ë‹¤ë¬¸í™” ì„¤ì • ë“±) ê°€ë…ì„± ê°•í™” */
    .acc > summary{cursor:pointer;list-style:none;display:flex;align-items:flex-start;justify-content:space-between;gap:10px;font-weight:900;font-size:18px;color:var(--titleAccent);}
    .acc > summary::-webkit-details-marker{display:none;}
    .acc > summary .subline{display:block;font-weight:700;color:var(--muted);font-size:13px;margin-top:4px;}
    /* í† ê¸€(í™”ì‚´í‘œ)ì„ ë” í¬ê²Œ/ëˆˆì— ë„ê²Œ */
    .acc > summary::after{content:"â–¾";opacity:.95;margin-top:2px;font-size:18px;transition:transform .15s ease;color:var(--titleAccent);}
    details[open].acc > summary::after{transform:rotate(90deg)}
    /* Accordion header contrast (active vs inactive) */
    .acc > summary span{font-weight:950;color:var(--text);}
    details[open].acc > summary span{color:var(--desc);}
    details[open].acc{background:rgba(96,165,250,.10);border-color:rgba(29,78,216,.22);}

    .accInner{padding-top:10px;}

    /* Accordion ì‚¬ìš© ì•ˆë‚´ ë¬¸êµ¬ */
    .accHint{font-size:16px;line-height:1.35;color:var(--text);font-weight:900;opacity:.95;}

    /* File upload button */
    .fileInputHidden{position:absolute;left:-9999px;width:1px;height:1px;opacity:0;}
  
    /* v4.1.1: ë„ì›€ë§ í† ê¸€(ìš”ì²­Â·ì œì•½) + ê°€ë…ì„± */
    #accConstraints select{ font-size:0.92em; }
    #accConstraints label{ font-weight:600; }
    .helpRow{ display:flex; justify-content:flex-end; margin-top:4px; margin-bottom:10px; }
    .helpBtn{
      display:inline-flex; align-items:center; gap:6px;
      background:rgba(255,233,166,0.10);
      border:1px solid rgba(255,233,166,0.45);
      color:var(--titleAccent);
      padding:5px 10px;
      border-radius:999px;
      font-size:12px;
      cursor:pointer;
      user-select:none;
    }
    .helpBtn:hover{ background:rgba(255,233,166,0.16); }
    .helpBtn.open{ background:rgba(255,233,166,0.22); }
    .helpIcon{
      width:16px; height:16px; display:inline-block; position:relative;
      border-radius:50%;
      background:rgba(255,233,166,0.20);
      border:1px solid rgba(255,233,166,0.55);
    }
    .helpIcon::before{
      content:"i";
      position:absolute; inset:0;
      display:flex; align-items:center; justify-content:center;
      font-weight:800; font-size:12px; line-height:1;
    }
    .helpText{
      margin-top:6px;
      padding:10px 12px;
      border-radius:12px;
      background:rgba(15,23,42,0.04);
      border:1px solid rgba(15,23,42,0.08);
      line-height:1.45;
    }

  
    /* Intro guide */
    .guideList{margin:10px 0 0 20px;padding:0;}
    .guideList li{margin:10px 0;line-height:1.5;}
    .btnRow{display:flex;gap:10px;flex-wrap:wrap;}

    /* Intro sections to reduce "all text" feel */
    .introSection{padding:12px;border:1px solid rgba(15,23,42,.10);background:rgba(15,23,42,.02);border-radius:12px;margin-top:12px}
    .introSection .panelTitle{margin:0 0 6px 0;font-size:14px}
    /* App how-to header (ivory card) */
    .howtoCard{background:rgba(255, 250, 240, 1);border-color:rgba(245,158,11,.25)}
    /* Intro section title (no "card-in-card" for subtitles) */
    .sectionTitle{
      margin:0 0 10px 0;
      font-size:18px;
      font-weight:950;
      letter-spacing:-0.2px;
      color:#7c2d12;
    }
    /* Keep a card-in-card look ONLY for ì•ˆë‚´ ë‚´ìš© */
    .innerCard{
      padding:10px 12px;
      border-radius:12px;
      background:rgba(255,255,255,.72);
      border:1px solid rgba(15,23,42,.10);
      box-shadow:0 6px 16px rgba(0,0,0,.10);
    }

    /* Note box (high contrast on light UI) */
    .noteBox{padding:10px 12px;border-radius:12px;background:rgba(254,249,195,1);border:1px solid rgba(245,158,11,.45);color:#111827;}

    /* Intro: separate action buttons area */
    .introActions{margin-top:12px;padding:12px;border-radius:12px;border:1px solid rgba(15,23,42,.10);background:rgba(15,23,42,.02);}

    /* Result header polish */
    .resultHeader{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;}
    .resultPills{display:flex;gap:10px;flex-wrap:wrap;align-items:center;}
    #resultTab .pill{font-size:13px;padding:8px 12px;}
    #resultTab .pill.ok{background:rgba(34,197,94,.14);border-color:rgba(34,197,94,.40)}
    #resultTab .pill.warn{background:rgba(255,107,107,.14);border-color:rgba(255,107,107,.55);color:#7f1d1d;font-weight:900;}
    #resultTab .pill.care{background:rgba(245,158,11,.14);border-color:rgba(245,158,11,.35);color:#78350f;font-weight:900;}

  
    /* --- Layout polish: ì¢Œì¸¡ ì„¤ì •/ìš°ì¸¡ ë¯¸ë¦¬ë³´ê¸° ê· í˜•(ìŠ¤í¬ë¡¤ ë¶„ë¦¬) --- */
    #setupTab .app{align-items:stretch; min-height: calc(100vh - 210px);}
    #setupTab aside.card{
      height: calc(100vh - 170px);
      display:flex;
      flex-direction:column;
      overflow:hidden;
    }
    #setupTab .asideScroll{
      overflow:auto;
      padding-right:6px;
      margin-top:10px;
    }
    #setupTab .rightCol{
      height: calc(100vh - 170px);
      overflow:auto;
      display:flex;
      flex-direction:column;
      gap:14px;
    }

    /* --- Select(í† ê¸€) í¬ê¸° í†µì¼ --- */
    #setupTab aside.card select{
      width: 260px;
      max-width: 100%;
      min-height: 44px;
      padding: 10px 12px;
    }

    /* --- Result spacing --- */
    #resultTab .small{line-height:1.55}
    .unsatTitle{font-weight:900; font-size:14px;}

    /* Smaller buttons inside 3-level summary area */
    #levelTabs .tabBtn{padding:8px 10px; font-size:13px;}
</style>
</head>
<body>
<header id="headerIntro">
  <div class="wrap">
    <h1>ğŸ“˜ ë°˜ë°°ì • ë„ìš°ë¯¸ ì›¹ì•±</h1>
    <div class="sub" style="margin-top:8px">
      <div class="privacy">ğŸ” ëª¨ë“  ì²˜ë¦¬ëŠ” <b>ì‚¬ìš©ì ë¸Œë¼ìš°ì €ì—ì„œë§Œ</b> ì´ë£¨ì–´ì§€ë©°, ì—…ë¡œë“œí•œ íŒŒì¼ê³¼ ë°ì´í„°ëŠ” <b>ì–´ë–¤ ì„œë²„ë¡œë„ ì „ì†¡ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤</b>.</div>
    </div>
  </div>
</header>

<header id="headerApp" style="display:none;">
  <div class="wrap">
    <div class="headerTop">
      <div>
        <h1>ğŸ“˜ ë°˜ë°°ì • ë„ìš°ë¯¸ ì›¹ì•±</h1>
        <div class="row" style="margin-top:10px">
          <span class="pill ok">ì„œë²„ ì „ì†¡ ì—†ìŒ</span>
          <span class="pill" id="filePill">ì—‘ì…€ ë¯¸ì„ íƒ</span>
          <span class="pill" id="rowsPill">0ëª…</span>
          <span class="pill" id="statusPill">ëŒ€ê¸°</span>
        </div>
      </div>
      <button type="button" class="homeBtn" id="homeBtn" title="í™ˆ(ì•ˆë‚´)ìœ¼ë¡œ">
        <!-- colored home icon (to avoid the bland grayscale look) -->
        <svg class="homeIcon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <!-- roof -->
          <path d="M3.5 10.6 12 4l8.5 6.6" fill="#60a5fa" stroke="#1e3a8a" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
          <!-- house body -->
          <path d="M6 10.2V20c0 .55.45 1 1 1h10c.55 0 1-.45 1-1v-9.8" fill="#fbbf24" stroke="#92400e" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
          <!-- door -->
          <path d="M10 21v-6.2c0-.44.36-.8.8-.8h2.4c.44 0 .8.36.8.8V21" fill="#fff" stroke="#78350f" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
          <!-- window -->
          <path d="M7.8 13.3h3.1v3.1H7.8z" fill="#e0f2fe" stroke="#0c4a6e" stroke-width="1.1"/>
        </svg>
        í™ˆ
      </button>
    </div>
    <div class="tabs">
      <button class="tabBtn active" id="tabSetup">ì„¤ì •</button>
      <button class="tabBtn" id="tabResult" disabled>ê²°ê³¼</button>
    </div>
  </div>
</header>

<main class="wrap">
  <section id="introView">
  <div class="card">
    <div class="introSection howtoCard">
      <div class="sectionTitle" aria-label="ì•± ì‚¬ìš©ë°©ë²•">ì•± ì‚¬ìš©ë°©ë²•</div>
      <div class="innerCard"><ol class="guideList">
        <li>ìƒ˜í”Œ ì–‘ì‹ì— í•™ìƒ ì •ë³´ë¥¼ ì…ë ¥</li>
        <li>ì‹¤í–‰ í™”ë©´ìœ¼ë¡œ ì´ë™</li>
        <li>ì—‘ì…€(.xlsx) ì—…ë¡œë“œ</li>
        <li>
          ì„¤ì •(ë°˜ ê°œìˆ˜/ê°€ì¤‘ì¹˜/ë¶„ë¦¬Â·ë°°ë ¤ ê°•ë„)
          <div class="small" style="margin-top:6px">
            â€¢ <b>ê°€ì¤‘ì¹˜</b>: í•™ì—…/êµìš°ê´€ê³„/ë¯¼ì› ë“± ì—¬ëŸ¬ ê¸°ì¤€ ì¤‘ ë¬´ì—‡ì„ ë” ìš°ì„ í• ì§€ ì •í•©ë‹ˆë‹¤. ê°’ì´ ë†’ì„ìˆ˜ë¡ í•´ë‹¹ ê¸°ì¤€ì´ ë” ë§ì´ ë°˜ì˜ë©ë‹ˆë‹¤.<br/>
            â€¢ <b>ë¶„ë¦¬ ê°•ë„</b>: ê°•ë„ê°€ ë†’ì„ìˆ˜ë¡ <b>ë¶„ë¦¬ìš”ì²­ì„ í•œ í•™ìƒì€ ê°€ëŠ¥í•œ í•œ ë‹¤ë¥¸ ë°˜</b>ìœ¼ë¡œ ë°°ì •í•©ë‹ˆë‹¤. ì˜ˆ) Aí•™ìƒê³¼ Bí•™ìƒì´ ê°™ì€ ë¶„ë¦¬ìš”ì²­ ê·¸ë£¹ì´ë©´, <b>ì„œë¡œ ë‹¤ë¥¸ ë°˜</b>ì´ ë˜ë„ë¡ ìš°ì„ í•©ë‹ˆë‹¤.<br/>â€¢ <b>ë°°ë ¤ ê°•ë„</b>: ê°•ë„ê°€ ë†’ì„ìˆ˜ë¡ <b>ë°°ë ¤ìš”ì²­ì„ í•œ í•™ìƒì€ ê°€ëŠ¥í•œ í•œ ê°™ì€ ë°˜</b>ìœ¼ë¡œ ë°°ì •í•©ë‹ˆë‹¤. ì˜ˆ) Cí•™ìƒê³¼ Dí•™ìƒì´ ê°™ì€ ë°°ë ¤ìš”ì²­ ê·¸ë£¹ì´ë©´, <b>ê°™ì€ ë°˜</b>ì´ ë˜ë„ë¡ ìš°ì„ í•©ë‹ˆë‹¤.
          </div>
        </li>
        <li>ë°˜ë°°ì • ì‹¤í–‰</li>
        <li>ê²°ê³¼ í™•ì¸ ë° ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</li>
      </ol></div>
    </div>

    <div class="introSection">
      <div class="sectionTitle" style="margin-bottom:10px">ì•ˆë‚´</div>
      <div class="innerCard">
        <div class="small">â€¢ ê²°ê³¼ëŠ” <b>â€œê²°ê³¼â€ íƒ­</b>ì—ì„œ í™•ì¸í•©ë‹ˆë‹¤.<br/>â€¢ ì•„ì´ì½˜ ì•ˆë‚´: ğŸ§© íŠ¹ìˆ˜ â”‚ ğŸŒ ë‹¤ë¬¸í™” â”‚ ğŸ§  ADHD â”‚ ğŸ”— ë¶„ë¦¬ìš”ì²­ â”‚ ğŸ¤ ë°°ë ¤ìš”ì²­</div>
      </div>
    </div>

    <div class="introSection">
      <div class="sectionTitle" style="margin-bottom:10px">ìƒ˜í”Œ ì–‘ì‹</div>
      <div class="innerCard"><div class="small">ì²˜ìŒ ì‚¬ìš©í•˜ì‹œë©´ ìœ„ ì–‘ì‹ì„ ë‚´ë ¤ë°›ì•„ <b>ì—´ ì´ë¦„/í˜•ì‹ì„ ìœ ì§€í•˜ë©° ì‘ì„±í•´ì£¼ì„¸ìš”.</b></div><div class="small" style="margin-top:6px;color:var(--subtle);">ëª¨ë“  ì¹¸ì„ ë‹¤ ì±„ìš°ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤. <b>ì…ë ¥ ê°€ëŠ¥í•œ í•­ëª©ë§Œ</b> ì‘ì„±í•´ë„ ì‹¤í–‰í•  ìˆ˜ ìˆì–´ìš”.</div></div>
    </div>

    <div class="introActions">
      <div class="btnRow">
        <a href="template.xlsx" download="ë°˜ë°°ì •_ì–‘ì‹_ìƒ˜í”Œ.xlsx" style="text-decoration:none;flex:1">
          <button type="button" class="btnSecondary mintBtn" style="width:100%">ìƒ˜í”Œ ì–‘ì‹ ë‹¤ìš´ë¡œë“œ</button>
        </a>
        <button type="button" class="btn" id="goAppBtn" style="flex:1">ì‹¤í–‰ í™”ë©´ìœ¼ë¡œ ì´ë™</button>
      </div>
    </div>
  </div>
</section>

  <section id="appView" style="display:none;">

  <!-- SETUP TAB -->
  <section id="setupTab">
    <div class="app">
      <aside class="card" style="position:sticky; top:120px;">
        <h2 class="panelTitle">âš™ï¸ ì„¤ì •</h2>
        <input id="fileInput" class="fileInputHidden" type="file" accept=".xlsx" />
        <button id="fileBtn" type="button" class="btnSecondary pinkBtn"><span class="btnIcon" aria-hidden="true">â­¡</span> í•™ìƒ ë°ì´í„° ì—…ë¡œë“œ(.xlsx)</button>
        <div class="asideScroll">
        <!-- â‘  ê¸°ë³¸ ì„¤ì • (ì´ˆê¸°: ë‹«í˜) -->
        <details class="acc" id="accBasic">
          <summary><span>â‘  ê¸°ë³¸ ì„¤ì •</span></summary>
          <div class="accInner">

            <label>1. ë°˜ ê°œìˆ˜</label>
            <input id="classCount" type="number" min="2" max="30" value="10" />
            <div class="divider"></div>

            <label>2. <strong style='font-size:1.05em'>ë‚¨/ì—¬ ì„±ë¹„ ê· í˜•(3ë‹¨ê³„)</strong></label>
            <select id="genderBalance">
              <option value="off">ë¯¸ì ìš©</option>
              <option value="medium">ë³´í†µ (ë°˜ë§ˆë‹¤ ë‚¨ë…€ ì°¨ì´ Â±2 ì •ë„ë¡œ ìœ ì§€)</option>
              <option value="strong" selected>ê°• (ë°˜ë§ˆë‹¤ ë‚¨ë…€ ì°¨ì´ Â±1 ì •ë„ë¡œ ìœ ì§€)</option>
            </select>
            <div class="divider"></div>

            <label>3. <strong style='font-size:1.05em'>ì‹œë®¬ë ˆì´ì…˜ ì •ë°€ë„(3ë‹¨ê³„)</strong><br><span class='subNote'>(ë†’ì„ìˆ˜ë¡ ë” ê· í˜• / ëŠë ¤ì§ˆ ìˆ˜ ìˆìŒ)</span></label>
            <select id="iterMode">
              <option value="low">ë‚®ìŒ (ë¹ ë¥´ê²Œ ì‹œë„)</option>
              <option value="medium" selected>ë³´í†µ (ê¶Œì¥)</option>
              <option value="high">ë†’ìŒ (ë” ì˜¤ë˜ ê³„ì‚°)</option>
            </select>
          </div>
        </details>

        <!-- â‘¡ í•™ì—…Â·ê´€ê³„Â·ë¯¼ì›Â·ë‹¤ë¬¸í™” ì„¤ì • (ê¸°ë³¸ ì ‘í˜) -->
        <details class="acc" id="accWeights">
          <summary><span>â‘¡ í•™ì—…Â·êµìš°ê´€ê³„Â·ë¯¼ì› ì„¤ì •</span></summary>
          <div class="accInner">
            <div class="small" style="margin-top:2px; opacity:.95;">* ê°€ì¤‘ì¹˜ëŠ” â€œë°˜ë°°ì • ì ìˆ˜â€ ê³„ì‚°ì— ì‚¬ìš©ë©ë‹ˆë‹¤. <b>ê°’ì´ ë†’ì„ìˆ˜ë¡</b> í•´ë‹¹ í•­ëª©ì´ ë°˜ë°°ì •ì— <b>ë” ê°•í•˜ê²Œ</b> ë°˜ì˜ë©ë‹ˆë‹¤.</div>
            <div style="margin-top:10px">
              <label>1. í•™ì—…ì„±ì·¨ ê°€ì¤‘ì¹˜</label>
              <input id="wAcad" type="range" min="0" max="600" value="160" step="10" />
              <div class="kv"><span>0</span><span id="wAcadV">160</span><span>600</span></div>
            </div>
            <div style="margin-top:10px">
              <label>2. êµìš°ê´€ê³„ ê°€ì¤‘ì¹˜</label>
              <input id="wPeer" type="range" min="0" max="600" value="160" step="10" />
              <div class="kv"><span>0</span><span id="wPeerV">160</span><span>600</span></div>
            </div>
            <div style="margin-top:10px">
              <label>3. í•™ë¶€ëª¨ë¯¼ì› ê°€ì¤‘ì¹˜</label>
              <input id="wParent" type="range" min="0" max="600" value="260" step="10" />
              <div class="kv"><span>0</span><span id="wParentV">260</span><span>600</span></div>
            </div>
	          </div>
        </details>

        <!-- â‘¢ ìš”ì²­Â·ì œì•½ ì„¤ì • (ê¸°ë³¸ ì ‘í˜) -->
        <details class="acc" id="accConstraints">
          <summary>
            <span>
              â‘¢ ìš”ì²­Â·ì œì•½ ì„¤ì •</span>
          </summary>
          <div class="accInner">
            <label>1. <strong style='font-size:1.05em'>ADHD í•™ìƒ ë°°ì •(3ë‹¨ê³„)</strong></label>
            <select id="adhdCap">
              <option value="off" selected>ë¯¸ì ìš©</option>
              <option value="normal">ë³´í†µ (ê°€ê¸‰ì  ë°˜ë³„ ê· ë“± ë¶„ì‚°)</option>
              <option value="strong">ê°• (ê°€ëŠ¥í•œ í•œ ê· ë“± ë¶„ì‚°)</option>
            </select>
            <div class="helpRow">
              <button type="button" class="helpBtn" data-help="help-adhd">
                <span class="helpIcon" aria-hidden="true"></span><span>ìì„¸íˆ</span>
              </button>
            </div>
            <div id="help-adhd" class="helpText small" hidden>â€¢ ì—‘ì…€ì— <b>ADHDì—¬ë¶€</b> ì—´ì´ ìˆìœ¼ë©´ Y/Në¡œ ì¸ì‹í•©ë‹ˆë‹¤.<br/>â€¢ <b>ë³´í†µ</b>: ê°€ëŠ¥í•œ í•œ ë°˜ë³„ë¡œ ê³ ë¥´ê²Œ ë¶„ì‚°ë˜ë„ë¡ ìš°ì„ í•©ë‹ˆë‹¤.<br/>â€¢ <b>ê°•</b>: ë¶„ì‚°ì„ ë” ê°•í•˜ê²Œ ë°˜ì˜í•©ë‹ˆë‹¤.</div>

            <label>2. <strong style='font-size:1.05em'>íŠ¹ìˆ˜í•™ìƒ ë°°ì •(3ë‹¨ê³„)</strong></label>
            <select id="specialMode">
              <option value="off" selected>ë¯¸ì ìš©</option>
              <option value="medium">ë³´í†µ (ê°€ê¸‰ì  ë°˜ë³„ ê· ë“± ë¶„ì‚°)</option>
              <option value="strong">ê°• (ê°€ëŠ¥í•œ í•œ ê· ë“± ë¶„ì‚°)</option>
            </select>
            <div class="helpRow">
              <button type="button" class="helpBtn" data-help="help-special">
                <span class="helpIcon" aria-hidden="true"></span><span>ìì„¸íˆ</span>
              </button>
            </div>
            <div id="help-special" class="helpText small" hidden>ì—‘ì…€ì— <b>íŠ¹ìˆ˜ì—¬ë¶€</b> ì—´ì´ ìˆìœ¼ë©´ Y/Në¡œ ì¸ì‹í•©ë‹ˆë‹¤.<br/>ì—´ì´ ì—†ìœ¼ë©´ ëª¨ë‘ Nìœ¼ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.</div>
            <div class="divider"></div>

            <label>3. <strong style='font-size:1.05em'>ë‹¤ë¬¸í™”í•™ìƒ ë°°ì •(3ë‹¨ê³„)</strong></label>
            <select id="multiMode">
              <option value="off" selected>ë¯¸ì ìš©</option>
              <option value="medium">ë³´í†µ (ê°€ê¸‰ì  ë°˜ë³„ ê· ë“± ë¶„ì‚°)</option>
              <option value="strong">ê°• (ê°€ëŠ¥í•œ í•œ ê· ë“± ë¶„ì‚°)</option>
            </select>
            <div class="helpRow">
              <button type="button" class="helpBtn" data-help="help-multi">
                <span class="helpIcon" aria-hidden="true"></span><span>ìì„¸íˆ</span>
              </button>
            </div>
            <div id="help-multi" class="helpText small" hidden>ì—‘ì…€ì— <b>ë‹¤ë¬¸í™”ì—¬ë¶€</b> ì—´ì´ ìˆìœ¼ë©´ Y/Në¡œ ì¸ì‹í•©ë‹ˆë‹¤.<br/>ì—´ì´ ì—†ìœ¼ë©´ ëª¨ë‘ Nìœ¼ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.</div>
            <div class="divider"></div>

            <label>4. <strong style='font-size:1.05em'>ë¶„ë¦¬ìš”ì²­ ê°•ë„</strong><br><span class='subNote'>(ê°™ì€ ë°˜ì´ ë˜ë©´ ì•ˆ ë¨)</span></label>
            <select id="sepStrength">
              <option value="strict">ì—„ê²© (ì›ì¹™ì ìœ¼ë¡œ ê°™ì€ ë°˜ ë°°ì • ê¸ˆì§€)</option>
              <option value="strong" selected>ê°• (ìµœëŒ€í•œ ë‹¤ë¥¸ ë°˜ìœ¼ë¡œ ë¶„ì‚°)</option>
              <option value="medium">ë³´í†µ (ê°€ê¸‰ì  ë‹¤ë¥¸ ë°˜ìœ¼ë¡œ ë¶„ì‚°)</option>
              <option value="weak">ì•½í•¨ (ê°€ëŠ¥í•˜ë©´ ë¶„ì‚°, ì—¬ê±´ì— ë”°ë¼ í—ˆìš©)</option>
            </select>

            <div style="margin-top:10px">
              <label>5. <strong style='font-size:1.05em'>ë°°ë ¤ìš”ì²­ ê°•ë„</strong><br><span class='subNote'>(ê°™ì€ ë°˜ì´ ë˜ë©´ ì¢‹ìŒ)</span></label>
              <select id="careStrength">
                <option value="strict">ì—„ê²© (ê°€ëŠ¥í•œ í•œ ê°™ì€ ë°˜ìœ¼ë¡œ ë°°ì •)</option>
                <option value="strong" selected>ê°• (ìµœëŒ€í•œ ê°™ì€ ë°˜ìœ¼ë¡œ ë°°ì •)</option>
                <option value="medium">ë³´í†µ (ê°€ê¸‰ì  ê°™ì€ ë°˜ìœ¼ë¡œ ë°°ì •)</option>
                <option value="weak">ì•½í•¨ (ê°€ëŠ¥í•˜ë©´ ê°™ì€ ë°˜, ì—¬ê±´ì— ë”°ë¼ í—ˆìš©)</option>
              </select>
            </div>
          </div>
        </details>

        </div>
        <div class="stickyRun">
          <button id="runBtn" type="button" disabled>ë°˜ë°°ì • ì‹¤í–‰ â†’ ê²°ê³¼ íƒ­ ë³´ê¸°</button>
          <div class="tip">ê²°ê³¼ê°€ ë§ˆìŒì— ì•ˆ ë“¤ë©´ ì„¤ì •ì„ ì¡°ê¸ˆ ì¡°ì •í•˜ê±°ë‚˜ ë‹¤ì‹œ ì‹¤í–‰í•´ ë³´ì„¸ìš” ğŸ˜Š</div>
        </div>
      </aside>

      <section class="rightCol">
        <section class="card">
          <h2 class="panelTitle">ğŸ“Š ê¸°ë³¸ í†µê³„</h2>
          <div id="stats" class="small">ì—‘ì…€ì„ ì—…ë¡œë“œí•˜ë©´ í†µê³„/ë¯¸ë¦¬ë³´ê¸°ê°€ í‘œì‹œë©ë‹ˆë‹¤.</div>
        </section>

        <!-- í˜„ì¬ ì„¤ì • ìš”ì•½ (ê¸°ë³¸ í†µê³„ â†” ë¯¸ë¦¬ë³´ê¸° ì‚¬ì´) -->
        <section class="card" id="settingsSummary" style="display:none;">
          <h2 class="panelTitle">ğŸ§¾ í˜„ì¬ ì„¤ì • ìš”ì•½</h2>
          <div class="small" id="settingsSummaryLines">-</div>
        </section>

        <section class="card">
          <h2 class="panelTitle">ğŸ” ë¯¸ë¦¬ë³´ê¸°(ìƒìœ„ 20ëª…)</h2>
          <div id="legendPreview" class="small" style="opacity:0.9; margin-top:-4px; margin-bottom:6px;">ì•„ì´ì½˜ ì•ˆë‚´: ğŸ§© íŠ¹ìˆ˜ â”‚ ğŸŒ ë‹¤ë¬¸í™” â”‚ ğŸ§  ADHD â”‚ ğŸ”— ë¶„ë¦¬ìš”ì²­ â”‚ ğŸ¤ ë°°ë ¤ìš”ì²­</div>
          <div id="errors" class="small danger"></div>
          <div style="overflow:auto; max-height: 420px;">
            <table id="previewTable"></table>
          </div>
        </section>

        <section class="card" id="nextStepsCard" style="display:none;">
          <h2 class="panelTitle">ğŸ‘‰ ë‹¤ìŒ ë‹¨ê³„</h2>
          <div class="small" id="nextStepsTxt">
            â‘  ë°˜ ê°œìˆ˜ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.<br/>
            â‘¡ ê°€ì¤‘ì¹˜ë¥¼ ê¸°ë³¸ê°’ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ê±°ë‚˜ í•„ìš” ì‹œ ì¡°ì •í•©ë‹ˆë‹¤.<br/>
            â‘¢ <b>ë°˜ë°°ì • ì‹¤í–‰</b> ë²„íŠ¼ì„ ëˆŒëŸ¬ ê²°ê³¼ íƒ­ì—ì„œ í™•ì¸í•©ë‹ˆë‹¤.
          </div>
        </section>
</section>
    </div>
  </section>

  <!-- RESULT TAB -->
  <section id="resultTab" style="display:none;">
    <div style="display:flex;flex-direction:column;gap:14px;">
      <section class="card">
        <h2 class="panelTitle">âœ… ë°˜ë°°ì • ê²°ê³¼</h2>
        <div class="resultHeader">
          <div class="resultPills">
            <span class="pill ok" id="metaPill">-</span>
            <span class="pill warn" id="sepPill">ë¶„ë¦¬ ë¯¸ì¶©ì¡±: -</span>
            <span class="pill care" id="carePill">ë°°ë ¤ ë¯¸ì¶©ì¡±: -</span>
          </div>
          <button id="downloadBtn" class="downloadBtn" style="width:auto;"><span class="btnIcon">â¬‡ï¸</span><span>ê²°ê³¼ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</span></button>
        </div>
      </section>

      <section class="chartGrid">
        <section class="card">
          <h2 class="panelTitle">ğŸ“Š ë°˜ë³„ ìš”ì•½</h2>
          <div id="classSummary" class="small">-</div>
        </section>
        <section class="card">
          <h2 class="panelTitle">âš ï¸ ê²°ê³¼ ë¦¬í¬íŠ¸</h2>
          <div id="violations" class="small">-</div>
        </section>
      </section>

      <section class="card" id="unsatisfiedCard">
        <h2 class="panelTitle">ğŸ” ë¯¸ì¶©ì¡± í•™ìƒ ëª©ë¡</h2>
        <div class="noteBox small" style="margin-bottom:10px">
          â€¢ <b>ë¶„ë¦¬ ë¯¸ì¶©ì¡±</b>: ê°™ì€ <b>ë¶„ë¦¬ìš”ì²­ ê·¸ë£¹(ìƒëŒ€í•™ìƒ)</b>ì´ ê°™ì€ ë°˜ì— í•¨ê»˜ ë°°ì •ëœ ê²½ìš°<br/>
          â€¢ <b>ë°°ë ¤ ë¯¸ì¶©ì¡±</b>: ê°™ì€ <b>ë°°ë ¤ìš”ì²­ ê·¸ë£¹(ìƒëŒ€í•™ìƒ)</b> ì¹œêµ¬ê°€ <b>ìê¸° ë°˜ì— 1ëª…ë„ ì—†ëŠ”</b> ê²½ìš°
        </div>
        
        <div class="unsatBlock">
          <div class="unsatTitle">ë¶„ë¦¬ ë¯¸ì¶©ì¡± ëª©ë¡ <span class="small" id="unsatSepMeta"></span></div>
          <div style="height:8px"></div>
          <div style="overflow:auto; max-height: 280px;">
            <table id="unsatSepTable"></table>
          </div>
        </div>
        <div style="height:14px"></div>
        <div class="unsatBlock">
          <div class="unsatTitle">ë°°ë ¤ ë¯¸ì¶©ì¡± ëª©ë¡ <span class="small" id="unsatCareMeta"></span></div>
          <div style="height:8px"></div>
          <div style="overflow:auto; max-height: 280px;">
            <table id="unsatCareTable"></table>
          </div>
        </div>
    
      </section>

      <section class="card">
        <h2 class="panelTitle">ğŸ“ˆ ê·¸ë˜í”„(ë°˜ë³„ ë¶„í¬)</h2>
        <div class="small">* ì•ˆì •ì„±ì„ ìœ„í•´ ì°¨íŠ¸ëŠ” ë°˜ì‘í˜•(responsive) OFF ìƒíƒœë¡œ ë Œë”ë§í•©ë‹ˆë‹¤.</div>
        <div style="height:12px"></div>
        <div class="chartGrid">
          <div class="card" style="padding:12px;">
            <div class="small">ë°˜ë³„ ì¸ì›</div>
            <div class="chartBox"><canvas id="cntChart" height="260"></canvas></div>
          </div>
          <div class="card" style="padding:12px;">
            <div class="small">ë°˜ë³„ ë‚¨/ì—¬</div>
            <div class="chartBox"><canvas id="genderChart" height="260"></canvas></div>
          </div>
        </div>
      </section>

      <section class="card">
        <h2 class="panelTitle">ğŸ“‹ ë°°ì •í‘œ</h2>
        <div id="legendResult" class="small" style="opacity:0.9; margin-top:-4px; margin-bottom:6px;">ì•„ì´ì½˜ ì•ˆë‚´: ğŸ§© íŠ¹ìˆ˜ â”‚ ğŸŒ ë‹¤ë¬¸í™” â”‚ ğŸ§  ADHD â”‚ ğŸ”— ë¶„ë¦¬ìš”ì²­ â”‚ ğŸ¤ ë°°ë ¤ìš”ì²­</div>
        <div class="row" style="margin-bottom:10px;">
          <label class="small">ë°˜ í•„í„°</label>
          <select id="classFilter"></select>
          <span class="small" id="tableMeta"></span>
        </div>
        <div id="legendResult" class="small" style="opacity:0.9; margin-top:-6px; margin-bottom:10px;">ì•„ì´ì½˜ ì•ˆë‚´: ğŸ§© íŠ¹ìˆ˜ â”‚ ğŸŒ ë‹¤ë¬¸í™” â”‚ ğŸ§  ADHD â”‚ ğŸ”— ë¶„ë¦¬ìš”ì²­ â”‚ ğŸ¤ ë°°ë ¤ìš”ì²­</div>
        <div style="overflow:auto; max-height: 560px;">
          <table id="resultTable"></table>
        </div>
      </section>
    </div>
  </section>

  </section>
</main>

<div class="overlay" id="overlay">
  <div class="box">
    <div class="row" style="gap:10px;">
      <span class="spinner"></span>
      <div>
        <div style="font-weight:900;">ë°˜ë°°ì •ì„ ê³„ì‚° ì¤‘â€¦</div>
        <div class="small" id="progressTxt">ì‹œë®¬ë ˆì´ì…˜ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.</div>
      </div>
    </div>
  </div>
</div>


<script>
(function(){
  function setStatus(txt){ var el=document.getElementById('statusPill'); if(el) el.textContent=txt; }
  function showErr(msg){
    var e=document.getElementById('errors');
    if(e){ e.textContent=msg; }
    setStatus('ì˜¤ë¥˜');
  }
  window.addEventListener('error', function(ev){
    showErr('ìŠ¤í¬ë¦½íŠ¸ ì˜¤ë¥˜: ' + (ev && ev.message ? ev.message : ev));
  });
  window.addEventListener('unhandledrejection', function(ev){
    showErr('ë¹„ë™ê¸° ì˜¤ë¥˜: ' + (ev && ev.reason ? (ev.reason.message || ev.reason) : ev));
  });
  window.addEventListener('DOMContentLoaded', function(){
    try{
      var inp=document.getElementById('fileInput');
      var fp=document.getElementById('filePill');
      if(inp){
        inp.addEventListener('change', function(){
          if(fp) fp.textContent = inp.files && inp.files[0] ? inp.files[0].name : 'ì—‘ì…€ ë¯¸ì„ íƒ';
          setStatus('íŒŒì¼ ì„ íƒë¨');
        });
      }
      // CDN ë¡œë“œ ì²´í¬(5ì´ˆ í›„)
      setTimeout(function(){
        if(!window.XLSX){
          showErr('ì—‘ì…€ ì²˜ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬(XLSX)ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.\ní•™êµ/ê¸°ê´€ ë„¤íŠ¸ì›Œí¬ì—ì„œ CDNì´ ì°¨ë‹¨ëœ ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤.\ní•´ê²°: ë‹¤ë¥¸ ë„¤íŠ¸ì›Œí¬(ëª¨ë°”ì¼ í•«ìŠ¤íŒŸ ë“±)ì—ì„œ ì ‘ì†í•˜ê±°ë‚˜, "ì˜¤í”„ë¼ì¸(ë¼ì´ë¸ŒëŸ¬ë¦¬ í¬í•¨)" ë²„ì „ìœ¼ë¡œ êµì²´í•˜ì„¸ìš”.');
        }
        if(!window.Chart){
          // ê·¸ë˜í”„ë§Œ ì‹¤íŒ¨í•  ìˆ˜ë„ ìˆìŒ
          var e=document.getElementById('errors');
          if(e && !e.textContent){
            e.textContent = 'ê·¸ë˜í”„ ë¼ì´ë¸ŒëŸ¬ë¦¬(Chart.js)ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.\nê·¸ë˜í”„ ì—†ì´ë„ ë°˜ë°°ì •ì€ ê°€ëŠ¥í•˜ì§€ë§Œ, í•™êµë§ì—ì„œ CDN ì°¨ë‹¨ ì‹œ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
          }
        }
      }, 5000);
    }catch(_){}
  });
})();
</script>

<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script src="./app.js?v=344"></script>
</body>
</html>
