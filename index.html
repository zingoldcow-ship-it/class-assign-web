<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ë°˜ë°°ì • ì›¹ì•± (ë¸Œë¼ìš°ì €ì—ì„œë§Œ ì‹¤í–‰)</title>
  <style>
    :root { --bg:#0b1020; --card:#121a33; --text:#e9ecf1; --muted:#a9b1c6; --accent:#7aa2ff; --danger:#ff6b6b; --ok:#3ddc97; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Noto Sans KR, Arial, sans-serif; background: var(--bg); color: var(--text); }
    header { padding: 16px 16px; border-bottom: 1px solid rgba(255,255,255,.08); position: sticky; top:0; background: rgba(11,16,32,.9); backdrop-filter: blur(8px); z-index: 50;}
    h1 { margin:0; font-size: 18px; }
    .sub { margin-top:6px; color: var(--muted); font-size: 13px; line-height: 1.4; }
    .wrap { max-width: 1300px; margin: 0 auto; padding: 14px; }
    .app { display:grid; grid-template-columns: 320px 1fr; gap: 14px; align-items: start; }
    @media (max-width: 980px){ .app { grid-template-columns: 1fr; } }
    .card { background: var(--card); border:1px solid rgba(255,255,255,.08); border-radius: 14px; padding: 14px; box-shadow: 0 8px 24px rgba(0,0,0,.25); }
    .row { display:flex; gap:10px; align-items:center; flex-wrap: wrap; }
    .pill { font-size: 12px; border:1px solid rgba(255,255,255,.14); padding: 6px 10px; border-radius: 999px; color: var(--muted); }
    .pill.ok { border-color: rgba(61,220,151,.55); color: #c9ffe9; }
    .pill.warn { border-color: rgba(255,107,107,.5); color: #ffd7d7; }
    label { font-size: 12px; color: var(--muted); display:block; margin-bottom: 6px;}
    input[type=file], input[type=number], input[type=range] { width: 100%; }
    input[type=file] { padding: 10px; border-radius: 12px; border:1px dashed rgba(255,255,255,.18); background: rgba(255,255,255,.03); color: var(--text); }
    input[type=number] { padding: 10px; border-radius: 12px; border: 1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.03); color: var(--text); }
    input[type=range] { accent-color: var(--accent); }
    .kv { display:flex; justify-content: space-between; gap: 10px; font-size: 12px; color: var(--muted); margin-top: 6px;}
    button { background: var(--accent); border:none; color:#071022; padding: 10px 12px; border-radius: 12px; font-weight: 800; cursor:pointer; width: 100%; }
    button:disabled { opacity: .4; cursor:not-allowed; }
    table { width:100%; border-collapse: collapse; font-size: 12px; }
    th, td { border-bottom: 1px solid rgba(255,255,255,.08); padding: 8px 6px; text-align:left; white-space: nowrap; }
    th { color: var(--muted); font-weight: 600; position: sticky; top: 0; background: rgba(18,26,51,.96); }
    .small { font-size: 12px; color: var(--muted); }
    .danger { color: var(--danger); }
    canvas { width:100%; height: 220px; }
    .footer { margin-top: 12px; color: var(--muted); font-size: 12px; }
    .panelTitle { font-size: 14px; margin:0 0 10px 0; }
    .divider { height: 1px; background: rgba(255,255,255,.08); margin: 12px 0; }
    .overlay { position: fixed; inset: 0; display:none; align-items: center; justify-content: center; background: rgba(0,0,0,.55); z-index: 100; }
    .overlay .box { background: var(--card); border:1px solid rgba(255,255,255,.14); padding: 16px; border-radius: 14px; max-width: 420px; width: calc(100% - 28px); }
    .spinner { width: 18px; height: 18px; border-radius: 50%; border: 3px solid rgba(255,255,255,.2); border-top-color: rgba(122,162,255,.9); animation: spin 1s linear infinite; display:inline-block; vertical-align: -4px; margin-right: 8px;}
    @keyframes spin { to { transform: rotate(360deg);} }
    a { color: #b9c9ff; }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>ğŸ“˜ ë°˜ë°°ì • ì›¹ì•± (ë¸Œë¼ìš°ì €ì—ì„œë§Œ ì‹¤í–‰ Â· ë°ì´í„° ì„œë²„ ì „ì†¡ 0)</h1>
      <div class="sub">
        ğŸ” ì—…ë¡œë“œí•œ ì—‘ì…€ì€ <b>ì¸í„°ë„·ìœ¼ë¡œ ì „ì†¡ë˜ì§€ ì•Šê³ </b> ì´ ë¸Œë¼ìš°ì € ì•ˆì—ì„œë§Œ ì½ê³  ì²˜ë¦¬í•©ë‹ˆë‹¤.<br/>
        v2: <b>ì‚¬ì´ë“œë°”(ì„¤ì •)</b> + <b>ë¡œë”© ê³ ì •</b> + <b>ê·¸ë˜í”„ ì¤‘ë³µ ìƒì„± ë°©ì§€</b>. (ë‹¤ìŒ ë‹¨ê³„: ë°˜ë°°ì • ì•Œê³ ë¦¬ì¦˜ + ê²°ê³¼ ë‹¤ìš´ë¡œë“œ)
      </div>
      <div class="row" style="margin-top:10px">
        <span class="pill ok" id="privacyPill">ì„œë²„ ì „ì†¡ ì—†ìŒ</span>
        <span class="pill" id="filePill">ì—‘ì…€ ë¯¸ì„ íƒ</span>
        <span class="pill" id="rowsPill">0ëª…</span>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div class="app">
      <!-- Sidebar -->
      <aside class="card" style="position: sticky; top: 86px;">
        <h2 class="panelTitle">âš™ï¸ ì„¤ì •</h2>

        <label>í•™ìƒ ë°ì´í„° ì—‘ì…€(.xlsx)</label>
        <input id="fileInput" type="file" accept=".xlsx" />

        <div class="divider"></div>

        <label>ë°˜ ê°œìˆ˜</label>
        <input id="classCount" type="number" min="2" max="20" value="10" />
        <div class="small">* v2ì—ì„œëŠ” ë°˜ê°œìˆ˜ëŠ” UIë§Œ ì œê³µí•©ë‹ˆë‹¤. (v3ì—ì„œ ë°˜ë°°ì • ë¡œì§ì— ì—°ê²°)</div>

        <div class="divider"></div>

        <label>ê°€ì¤‘ì¹˜(ìš°ì„ ìˆœìœ„) - v3ì—ì„œ ë°˜ì˜</label>

        <div style="margin-top:10px">
          <label>í•™ì—…ì„±ì·¨ ê°€ì¤‘ì¹˜</label>
          <input id="wAcad" type="range" min="0" max="600" value="160" step="10" />
          <div class="kv"><span>0</span><span id="wAcadV">160</span><span>600</span></div>
        </div>

        <div style="margin-top:10px">
          <label>êµìš°ê´€ê³„ ê°€ì¤‘ì¹˜</label>
          <input id="wPeer" type="range" min="0" max="600" value="160" step="10" />
          <div class="kv"><span>0</span><span id="wPeerV">160</span><span>600</span></div>
        </div>

        <div style="margin-top:10px">
          <label>í•™ë¶€ëª¨ë¯¼ì› ê°€ì¤‘ì¹˜</label>
          <input id="wParent" type="range" min="0" max="600" value="260" step="10" />
          <div class="kv"><span>0</span><span id="wParentV">260</span><span>600</span></div>
        </div>

        <div class="divider"></div>

        <button id="runBtn" disabled>ë°˜ë°°ì • ì‹¤í–‰ (v3ì—ì„œ í™œì„±í™”)</button>
        <div class="footer">
          * v2ëŠ” â€œêµì‚¬ìš© í™”ë©´ êµ¬ì„± ì•ˆì •í™”â€ ë‹¨ê³„ì…ë‹ˆë‹¤.<br/>
          ë‹¤ìŒ ë‹¨ê³„(v3): ë°˜ë°°ì • ì•Œê³ ë¦¬ì¦˜ + ê²°ê³¼ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ + ë°˜ë³„ ê·¸ë˜í”„.
        </div>
      </aside>

      <!-- Main -->
      <section style="display:flex; flex-direction: column; gap: 14px;">
        <section class="card">
          <h2 class="panelTitle">ğŸ“Š ê¸°ë³¸ í†µê³„</h2>
          <div id="stats" class="small">ì—‘ì…€ì„ ì„ íƒí•˜ë©´ í†µê³„ê°€ í‘œì‹œë©ë‹ˆë‹¤.</div>
        </section>

        <section class="card">
          <h2 class="panelTitle">ğŸ” ë¯¸ë¦¬ë³´ê¸°(ìƒìœ„ 20ëª…)</h2>
          <div id="errors" class="small danger"></div>
          <div style="overflow:auto; max-height: 420px;">
            <table id="previewTable"></table>
          </div>
        </section>

        <section class="card">
          <h2 class="panelTitle">ğŸ“ˆ ê·¸ë˜í”„(í•œëˆˆì— ë³´ê¸°)</h2>
          <div class="small">í˜„ì¬ëŠ” â€œì „ì²´ ë¶„í¬â€ ê·¸ë˜í”„ë§Œ í‘œì‹œí•©ë‹ˆë‹¤. (ë‹¤ìŒ ë‹¨ê³„: â€˜ë°˜ë°°ì • í›„ ë°˜ë³„ ë¶„í¬â€™ ê·¸ë˜í”„)</div>
          <div style="height:10px"></div>
          <div class="row" style="gap:14px;">
            <div class="card" style="padding: 12px; flex:1; min-width: 280px;">
              <div class="small">ì„±ë³„ ë¶„í¬</div>
              <canvas id="genderChart"></canvas>
            </div>
            <div class="card" style="padding: 12px; flex:1; min-width: 280px;">
              <div class="small">íŠ¹ìˆ˜/ADHD</div>
              <canvas id="needsChart"></canvas>
            </div>
          </div>
          <div style="height:14px"></div>
          <div class="row" style="gap:14px;">
            <div class="card" style="padding: 12px; flex:1; min-width: 260px;">
              <div class="small">í•™ì—…ì„±ì·¨(ì¢‹/ë³´/ë‚˜)</div>
              <canvas id="acadChart"></canvas>
            </div>
            <div class="card" style="padding: 12px; flex:1; min-width: 260px;">
              <div class="small">êµìš°ê´€ê³„(ì¢‹/ë³´/ë‚˜)</div>
              <canvas id="peerChart"></canvas>
            </div>
            <div class="card" style="padding: 12px; flex:1; min-width: 260px;">
              <div class="small">í•™ë¶€ëª¨ë¯¼ì›(ì¢‹/ë³´/ë‚˜)</div>
              <canvas id="parentChart"></canvas>
            </div>
          </div>
        </section>

      </section>
    </div>
  </main>

  <div class="overlay" id="overlay">
    <div class="box">
      <div class="row" style="gap:10px;">
        <span class="spinner"></span>
        <div>
          <div style="font-weight:800;">ì—‘ì…€ì„ ì½ê³  ìˆì–´ìš”â€¦</div>
          <div class="small">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”. (ë°ì´í„°ëŠ” ì„œë²„ë¡œ ì „ì†¡ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤)</div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="./app.js"></script>
</body>
</html>
